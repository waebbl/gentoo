From: Bernd Waibel <waebbl-gentoo@posteo.net>
Date: Sun, 23 May 2021 23:58:51 +0200
Subject: [PATCH] use versioned openexr

Signed-off-by: Bernd Waibel <waebbl-gentoo@posteo.net>
---
 source/base/image/openexr.cpp   |  8 ++++----
 unix/config/ax_check_openexr.m4 | 10 +++++-----
 2 files changed, 9 insertions(+), 9 deletions(-)

diff --git a/source/base/image/openexr.cpp b/source/base/image/openexr.cpp
index 224b384..1dea0b8 100644
--- a/source/base/image/openexr.cpp
+++ b/source/base/image/openexr.cpp
@@ -55,10 +55,10 @@
 
 #else
 
-#include <OpenEXR/ImfRgbaFile.h>
-#include <OpenEXR/ImfStringAttribute.h>
-#include <OpenEXR/ImfMatrixAttribute.h>
-#include <OpenEXR/ImfArray.h>
+#include <OpenEXR-2/ImfRgbaFile.h>
+#include <OpenEXR-2/ImfStringAttribute.h>
+#include <OpenEXR-2/ImfMatrixAttribute.h>
+#include <OpenEXR-2/ImfArray.h>
 
 #endif
 #include "metadata.h"
diff --git a/unix/config/ax_check_openexr.m4 b/unix/config/ax_check_openexr.m4
index 69a2cb6..62d8ea6 100644
--- a/unix/config/ax_check_openexr.m4
+++ b/unix/config/ax_check_openexr.m4
@@ -23,7 +23,7 @@ AC_DEFUN([AX_CHECK_OPENEXR],
   AC_CHECK_PROGS([PKGCONFIG], [pkg-config])
 
   AC_MSG_CHECKING([for OpenEXR's pkg-config])
-  ax_check_openexr=`pkg-config --print-errors OpenEXR 2>&1`
+  ax_check_openexr=`pkg-config --print-errors OpenEXR-2 2>&1`
   if test x"$ax_check_openexr" != x""; then
     ax_check_openexr="not found"
     AC_MSG_RESULT([$ax_check_openexr])
@@ -31,7 +31,7 @@ AC_DEFUN([AX_CHECK_OPENEXR],
     AC_MSG_RESULT([yes])
 
     AC_MSG_CHECKING([for OpenEXR version >= $1])
-    ax_check_openexr_version=`pkg-config --modversion OpenEXR 2>&1 | tail -1 | grep -v "No package"`
+    ax_check_openexr_version=`pkg-config --modversion OpenEXR-2 2>&1 | tail -1 | grep -v "No package"`
     if test x"$ax_check_openexr_version" != x""; then
       AX_COMPARE_VERSION([$ax_check_openexr_version], [ge], [$1], [ax_check_openexr="ok"], [ax_check_openexr="bad"])
       AC_MSG_RESULT([$ax_check_openexr_version, $ax_check_openexr])
@@ -41,8 +41,8 @@ AC_DEFUN([AX_CHECK_OPENEXR],
     fi
 
     if test x"$ax_check_openexr" = x"ok"; then
-      ax_check_openexr_cflags=`pkg-config --cflags OpenEXR 2> /dev/null`
-      ax_check_openexr_libs=`pkg-config --libs OpenEXR 2> /dev/null`
+      ax_check_openexr_cflags=`pkg-config --cflags OpenEXR-2 2> /dev/null`
+      ax_check_openexr_libs=`pkg-config --libs OpenEXR-2 2> /dev/null`
       ax_check_openexr_save_cppflags="$CPPFLAGS"
       ax_check_openexr_save_libs="$LIBS"
       CPPFLAGS="$ax_check_openexr_cflags $CPPFLAGS"
@@ -55,7 +55,7 @@ AC_DEFUN([AX_CHECK_OPENEXR],
 
       # check include file
       AC_CHECK_HEADER(
-        [OpenEXR/ImfCRgbaFile.h],
+        [OpenEXR-2/ImfCRgbaFile.h],
         [AC_CHECK_LIB([IlmImf], [ImfInputReadPixels], [], [ax_check_openexr="not found"])],
         [ax_check_openexr="no headers"]
       )
-- 
2.31.1

