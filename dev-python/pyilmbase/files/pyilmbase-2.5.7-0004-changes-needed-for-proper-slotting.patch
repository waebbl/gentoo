From: Bernd Waibel <waebbl-gentoo@posteo.net>
Date: Thu, 24 Jun 2021 17:36:32 +0200
Subject: [PATCH] changes needed for proper slotting

Signed-off-by: Bernd Waibel <waebbl-gentoo@posteo.net>
---
 PyIlmBase.pc.in             | 4 ++--
 PyImathNumpy/CMakeLists.txt | 2 +-
 config/ModuleDefine.cmake   | 6 +++---
 3 files changed, 6 insertions(+), 6 deletions(-)

diff --git a/PyIlmBase.pc.in b/PyIlmBase.pc.in
index 7caaf7b..bf08539 100644
--- a/PyIlmBase.pc.in
+++ b/PyIlmBase.pc.in
@@ -5,9 +5,9 @@
 
 prefix=@prefix@
 exec_prefix=@exec_prefix@
-libdir=@libdir@
+libdir=@libdir@/@PYILMBASE_OUTPUT_SUBDIR@
 includedir=@includedir@
-PyIlmBase_includedir=@includedir@/OpenEXR
+PyIlmBase_includedir=@includedir@/@PYILMBASE_OUTPUT_SUBDIR@
 
 Name: PyIlmBase
 Description: Python bindings for the IlmBase libraries
diff --git a/PyImathNumpy/CMakeLists.txt b/PyImathNumpy/CMakeLists.txt
index 2822127..812beed 100644
--- a/PyImathNumpy/CMakeLists.txt
+++ b/PyImathNumpy/CMakeLists.txt
@@ -49,5 +49,5 @@ if(TARGET Python3::Python AND
     LIBRARY_OUTPUT_NAME "imathnumpy"
     DEBUG_POSTFIX ""
   )
-  install(TARGETS imathnumpy_python3 DESTINATION ${PyIlmBase_Python3_SITEARCH_REL})
+  install(TARGETS imathnumpy_python3 DESTINATION ${PyIlmBase_Python3_SITEARCH_REL}/${PYILMBASE_OUTPUT_SUBDIR})
 endif()
diff --git a/config/ModuleDefine.cmake b/config/ModuleDefine.cmake
index 7c60315..b065bb8 100644
--- a/config/ModuleDefine.cmake
+++ b/config/ModuleDefine.cmake
@@ -54,8 +54,8 @@ function(PYILMBASE_ADD_LIBRARY_PRIV libname)
   install(TARGETS ${libname}
     EXPORT ${PROJECT_NAME}
     RUNTIME DESTINATION ${CMAKE_INSTALL_BINDIR}
-    LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR}
-    ARCHIVE DESTINATION ${CMAKE_INSTALL_LIBDIR}
+    LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR}/${PYILMBASE_OUTPUT_SUBDIR}
+    ARCHIVE DESTINATION ${CMAKE_INSTALL_LIBDIR}/${PYILMBASE_OUTPUT_SUBDIR}
   )
 endfunction()
 
@@ -153,6 +153,6 @@ function(PYILMBASE_DEFINE_MODULE modname)
       LIBRARY_OUTPUT_NAME "${modname}"
       DEBUG_POSTFIX ""
     )
-    install(TARGETS ${modname}_python3 DESTINATION ${PyIlmBase_Python3_SITEARCH_REL})
+    install(TARGETS ${modname}_python3 DESTINATION ${PyIlmBase_Python3_SITEARCH_REL}/${PYILMBASE_OUTPUT_SUBDIR})
   endif()
 endfunction()
-- 
2.32.0

